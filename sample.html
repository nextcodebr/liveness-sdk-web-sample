<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sample Liveness Web</title>
    <script src="dist/Liveness.js"></script>
  </head>
  <body>
    <div id="video-wrapper"></div>
    <script>
      async function start() {
        const apiKey = "5ea2dac171cb6d71e7cbfffb:yaGmMPV7v1Hmhlf5ptmSWMYs";
        const jwt = await getJWT(apiKey);

        const config = {
          width: 720, // largura de exibição da câmera
          isDebug: false,
          token: jwt,
          faceapiPath: "/libs", // caminho para a faceapi e os modelos
          livenessUrlBase: "https://api-homolog.nxcd.app", // endpoint da api liveness
          livenessConfirmEndpoint: "", // opcional - default: /liveness
          isShowPreview: true, // exibir um preview da foto que será enviada
          errorCallback: error, // metodo de callback em caso de erro
          successCallback: success, // metodo de callback em caso de sucesso
        };
        const videoWrapper = document.getElementById("video-wrapper"); // obter elemento na tela onde o liveness será injetado
        const liveness = new Liveness(videoWrapper, config); // instancia o liveness
        liveness.start();
      }

      function success(response) {
        console.log("success", response);
      }
      function error(error) {
        console.log("error", error);
      }

      async function getJWT(apiKey) {
        const requestOptions = {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `ApiKey ${apiKey}`,
          },
        };
        const endpoint = "https://api-homolog.nxcd.app/auth-jwt";
        const response = await fetch(endpoint, requestOptions);
        const token = await response.json();
        return token.accessToken;
      }
      start();
    </script>
  </body>
</html>
