{"version":3,"sources":["webpack://Liveness/./src/Livenessv5.js","webpack://Liveness/webpack/bootstrap","webpack://Liveness/webpack/startup"],"names":["module","exports","constructor","videoWrapper","config","windowWidth","window","innerWidth","width","height","Math","floor","this","token","faceapi","configFrameBox","frameBox","cssOrientationStyle","document","createElement","innerText","cssOrientationLock","head","appendChild","brightnessControl","luminanceControl","faceapiPath","isShowPreview","errorCallback","successCallback","livenessUrlBase","displaySize","livenessConfirmEndpoint","maskStyle","innerHTML","body","insertAdjacentElement","setMinBrightness","value","setMinLuminance","setFrameBoxesWidth","eyesInner","eyesOutter","box","setEyesBoxHeight","pixels","configEyesBoxHeight","stop","video","pause","stream","getTracks","forEach","track","setLiveness","loadFaceApi","setLoading","createModalConfirmationWrapper","createModalConfirmation","createVideoElement","startVideo","resetLiveness","removeCanvas","resetVideoWrapper","closePreviewModal","base64","removeLoading","createCanvasBackground","canvasBackground","clientWidth","clientHeight","style","display","sweepVideo","data","luminanceAvg","brightnessSum","luminanceArray","x","length","r","g","b","sweepBrightness","sweepLuminance","checkBrightness","brightness","calcLuminance","push","luminance","colorFactor","colorArray","i","pow","script","faceJS","src","append","onload","async","loadFaceApiModels","setTimeout","Promise","all","nets","faceLandmark68Net","loadFromUri","faceExpressionNet","faceRecognitionNet","then","tinyFaceDetector","console","log","catch","e","undefined","navigator","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","resolve","reject","call","Error","min","max","frameRate","querySelector","srcObject","URL","createObjectURL","err","error","transform","setAttribute","position","setVideoMask","addEventListener","createMessageBox","loop","getElementById","canvas","getElementsByTagName","remove","insertAdjacentHTML","createMask","maskEllipse","svgMask","responsiveFrameBoxEyesOutterWidth","includes","createCanvasFromMedia","left","top","minHeight","svgTag","matchDimensions","boxesWidth","marginTop","ctx","getContext","translate","scale","isDebug","draw","canvasPosition","getBoundingClientRect","state","counter","inProgress","done","timerBackground","setInterval","checkBackground","timer","detections","detectSingleFace","TinyFaceDetectorOptions","withFaceLandmarks","withFaceExpressions","blockMask","resizedDetections","resizeResults","expressions","expression","getExpression","detection","pose","getPose","jaw","landmarks","getJawOutline","isRotatedFace","beginPath","lineWidth","strokeStyle","moveTo","y","lineTo","stroke","leftEye","meanPosition","isInside","outterBox","innerBox","rightEye","isBackgroundOK","activateEllipseMask","takePicture","clearInterval","classList","add","deactivateEllipseMask","clearRect","rect","expArr","key","Object","entries","confidence","exp","sort","a","pop","res","eye_right","getMeanPosition","getRightEye","eye_left","getLeftEye","nose","getNose","mouth","getMouth","rx","getTop","ry","score","p1","p2","abs","atan2","PI","l","map","reduce","message","dimensions","msg","elMessage","textContent","context","createFlashMask","drawImage","toDataURL","removeFlashMask","openPreviewModal","confirmPicture","pictureData","getImageData","table","brilho","atual","parseFloat","toFixed","flash","background","zIndex","id","modalWrapper","modalConfirmation","confirmButton","cancelButton","footer","cancelPicture","image","modal","spinner","base64Local","requestOptions","method","headers","JSON","stringify","replace","endpoint","fetch","response","json","result","statusCode","alert","finally","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","__webpack_modules__"],"mappings":"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","file":"liveness.js","sourcesContent":["\"use strict\";\nclass Liveness {\n\n  constructor (videoWrapper, config) {\n    const windowWidth = window.innerWidth\n    if (config.width >= windowWidth) {\n      config.width = windowWidth\n    }\n\n    config.height = Math.floor(config.width * 0.7778)\n    this.config = config\n    this.token = config.token\n    this.videoWrapper = videoWrapper\n    this.faceapi = null\n    this.configFrameBox = config.frameBox\n\n    const cssOrientationStyle = document.createElement('style')\n    cssOrientationStyle.innerText = this.cssOrientationLock()\n    document.head.appendChild(cssOrientationStyle)\n    \n    if (config.brightnessControl) this.brightnessControl = config.brightnessControl\n    else this.brightnessControl = 95\n\n    if (config.luminanceControl) this.luminanceControl = config.luminanceControl\n    else this.luminanceControl = 23\n\n    this.faceapiPath = config.faceapiPath\n    this.isShowPreview = config.isShowPreview\n    this.errorCallback = config.errorCallback\n    this.successCallback = config.successCallback\n    this.livenessUrlBase = config.livenessUrlBase\n    this.displaySize = { width: config.width, height: config.height }\n    this.livenessConfirmEndpoint = config.livenessConfirmEndpoint || '/liveness/v2'\n\n    const maskStyle = document.createElement('style')\n    maskStyle.innerHTML = `\n      #path.active {\n        stroke: #46E3C3 !important;\n        stroke-width: 10 !important;\n      }\n      #mask-wrapper {\n        top: 0;\n        left: 0;\n        z-index: 1;\n        width: 100%;\n        height: 100%;\n        position: absolute;\n        transition: all 0.9s ease-in-out;\n        background-color: transparent;\n      }\n\n      #mask-wrapper svg > rect{\n        fill: transparent;\n        mask: url(#svg-mask);\n      }\n\n      #svg-mask{\n        min-height: 100%\n      }\n\n      #svg-mask rect{\n        display: flex;\n        fill: rgba(255, 255, 255, 0.5);\n        min-width: 100%;\n        min-height: 100%;\n      }\n      #mask-path {\n        transition: all 0.7s;\n        transform: translateX(23%) translateY(11%) scale(0.95) scaleX(1.1);\n        stroke: white;\n        stroke-width: 3;\n      }\n      #path {\n        fill: transparent;\n        transition: all 0.3s;\n        transform: translateX(23%) translateY(11%) scale(0.95) scaleX(1.1);\n        stroke: #D02780 !important;\n        stroke-width: 3;\n      }\n      @media screen and (min-width: 280px){\n        #mask-path {\n        }\n      }\n      @media screen and (min-width: 320px){\n        #path {\n          transform: translateX(28%) translateY(14%) scaleX(0.7) scaleY(0.67);\n        }\n      }\n      @media screen and (min-width: 360px){\n        #path {\n          transform: translateX(28.3%) translateY(8%) scaleX(0.8) scaleY(0.85);\n        }\n      }\n      @media screen and (min-width: 375px){\n        #path {\n          transform: translateX(27%) translateY(4%) scaleX(0.9) scaleY(0.9)\n        }\n      }\n      @media screen and (min-width: 390px){\n        #path {\n          transform: translateX(25.5%) translateY(8%) scaleX(1) scaleY(0.9);\n        }\n      }\n      @media screen and (min-width: 393px){\n        #mask-path {\n        }\n      }\n      @media screen and (min-width: 412px){\n        #path {\n          transform: translateX(26.8%) translateY(6%) scaleX(1) scaleY(0.95)\n        }\n      }\n      @media screen and (min-width: 414px){\n        #path {\n          transform: translateX(27.2%) translateY(9%) scaleX(1) scaleY(0.95);\n        }\n      }\n      @media screen and (min-width: 768px){\n        #path, #mask-path {\n          transform: translateX(24%) translateY(3%) scale(2) scaleX(1);\n        }\n      }\n    `\n    document.body.insertAdjacentElement('afterbegin', maskStyle)\n  }\n\n  setMinBrightness (value) {\n    this.brightnessControl = value\n  }\n\n  setMinLuminance (value) {\n    this.luminanceControl = value\n  }\n\n  setFrameBoxesWidth (eyesInner, eyesOutter, box) {\n    this.configFrameBox = {\n      eyesInner,\n      eyesOutter,\n      box\n    }\n  }\n  setEyesBoxHeight (pixels) {\n    this.configEyesBoxHeight = pixels\n  }\n\n  stop () {\n    this.video.pause()\n    const tracks = this.stream.getTracks()\n    tracks.forEach(track => track.stop())\n  }\n\n  async start () {\n    if (!window.faceapi) {\n      await this.loadFaceApi()\n    } else {\n      this.faceapi = window.faceapi\n      this.setLiveness()\n    }\n  }\n\n  setLiveness () {\n    this.setLoading()\n    this.createModalConfirmationWrapper()\n    .createModalConfirmation()\n    .createVideoElement()\n    .startVideo()\n  }\n  resetLiveness () {\n    this.removeCanvas()\n    this.resetVideoWrapper()\n    this.closePreviewModal()\n    this.base64 = ''\n    this.removeLoading()\n    this.setLiveness()\n  }\n\n  cssOrientationLock () {\n    return '@media screen and (min-width: 320px) and (max-width: 767px) and (orientation: landscape) { html { transform: rotate(-90deg);transform-origin: left top;width: 100vh;overflow-x: hidden;position: absolute;top: 100%;left: 0;}}'\n  }\n\n  createCanvasBackground () {\n    this.canvasBackground = document.createElement('canvas')\n    const width = this.videoWrapper.clientWidth\n    const height = this.videoWrapper.clientHeight\n    if (window.innerWidth < 720) {\n      this.canvasBackground.width = width * 2\n      this.canvasBackground.height = height * 2\n    } else {\n      this.canvasBackground.width = width\n      this.canvasBackground.height = height\n    }\n\n    this.canvasBackground.style.display = 'none'\n  }\n\n  sweepVideo (data) {\n    this.luminanceAvg = 0\n    this.brightnessSum = 0 \n    this.luminanceArray = []\n\n    for (let x = 0; x < data.length; x += 4) {\n      const r = data[x]\n      const g = data[x + 1]\n      const b = data[x + 2]\n      this.sweepBrightness(r, g, b)\n      this.sweepLuminance(r, g, b)\n    }\n    this.checkBrightness()\n  }\n\n  checkBrightness () {\n    this.brightness = Math.floor(this.brightnessSum / (this.canvasBackground.width * this.canvasBackground.height))\n  }\n\n  sweepBrightness (r, g, b) {\n    this.brightnessSum += Math.floor((r + g + b) / 3)\n  }\n\n  sweepLuminance (r, g, b) {\n    this.luminanceAvg += this.calcLuminance(r, g, b)\n    this.luminanceArray.push(this.calcLuminance(r, g, b))     \n\n    this.luminance = (this.luminanceAvg / this.luminanceArray?.length) * 100\n  }\n\n  calcLuminance (r, g, b) {\n    let colorArray = [r, g, b]\n    let colorFactor\n    for (let i = 0; i < colorArray.length; i++) {\n        colorFactor = colorArray[i] / 255\n        if (colorFactor <= 0.03928) {\n            colorFactor = colorFactor / 12.92\n        } else {\n            colorFactor = Math.pow(((colorFactor + 0.055) / 1.055), 2.4)\n        }\n        colorArray[i] = colorFactor\n    }\n    return (colorArray[0] * 0.2126 + colorArray[1] * 0.7152 + colorArray[2] * 0.0722) + 0.05\n  }\n\n\n  async loadFaceApi () {\n    const script = document.createElement('script')\n    const faceJS = `${this.faceapiPath}/face-api.min.js`\n    script.src = faceJS\n    document.head.append(script)\n    script.onload = async () => {\n      await this.loadFaceApiModels()\n    }\n    return this\n  }\n  async loadFaceApiModels () {\n    setTimeout(async () => {\n      Promise.all([\n        window.faceapi.nets.faceLandmark68Net.loadFromUri(this.faceapiPath),\n        window.faceapi.nets.faceExpressionNet.loadFromUri(this.faceapiPath),\n        window.faceapi.nets.faceRecognitionNet.loadFromUri(this.faceapiPath)\n      ])\n      .then(async () => {\n        await window.faceapi.nets.tinyFaceDetector.loadFromUri(this.faceapiPath)\n        console.log('Models were loaded')\n        this.faceapi = faceapi\n        this.setLiveness()\n      })\n      .catch(e => console.log('errando', e))\n    }, 100)\n    return this\n  }\n\n  startVideo () {\n    if (navigator.mediaDevices === undefined) {\n      navigator.mediaDevices = {}\n    }\n    if (navigator.mediaDevices.getUserMedia === undefined) {\n      navigator.mediaDevices.getUserMedia = function(constraints) {\n        const getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia\n        if (!getUserMedia) {\n          return Promise.reject(new Error('getUserMedia não implementado nesse browser'))\n        }\n        return new Promise(function(resolve, reject) {\n          getUserMedia.call(navigator, constraints, resolve, reject)\n        })\n      }\n    }\n    navigator.mediaDevices.getUserMedia({\n        video: {          \n          width: {\n            min: this.config.width,\n            max: this.config.width\n          },\n          height: {\n            min: this.config.height,\n            max: this.config.height\n          },\n          frameRate: 24\n        }\n      }).then((stream) => {\n        const video = document.querySelector('video')\n        this.stream = stream\n        if (\"srcObject\" in video) {\n          video.srcObject = stream\n        } else {\n          video.src = window.URL.createObjectURL(stream)\n        }\n      }).catch(err => console.error(err))\n    return this\n  }\n  createVideoElement () {\n    this.video = document.createElement('video')\n    this.video.style.width = '100%'\n    this.video.style.height = '100%'\n    this.video.style.transform = 'scaleX(-1)'\n    this.video.setAttribute('muted', true)\n    this.video.setAttribute('autoplay', true)\n    this.video.setAttribute('playsinline', '')\n    this.videoWrapper.style.position = 'relative'\n    this.videoWrapper.style.width = this.config.width\n    this.videoWrapper.style.height = this.config.height\n    this.videoWrapper.append(this.video)\n    this.setVideoMask()\n    this.video.addEventListener('play', () => {\n      this.createMessageBox()\n      this.loop()\n      this.createCanvasBackground()\n    })\n    return this\n  }\n  resetVideoWrapper () {\n    const videoWrapper = document.getElementById('video-wrapper')\n    if(videoWrapper) videoWrapper.innerHTML = ''\n  }\n\n  removeCanvas () {\n    const canvas = document.getElementsByTagName('canvas')[0]\n    if(canvas) canvas.remove()\n  }\n\n  setVideoMask () {\n    this.videoWrapper.insertAdjacentHTML('beforeend', this.createMask())\n    this.maskEllipse = document.getElementById('path')\n    this.svgMask = document.getElementById('mask-wrapper')\n    this.svgMask.style.width = this.config.width\n    this.svgMask.style.height = this.config.height\n  }\n  createMask () {\n    return `\n    <div\n      id=\"mask-wrapper\"\n    >\n      <svg id=\"svg-tag\" height=\"100%\" width=\"100%\" >\n        <path id=\"path\" d=\"M90.3388 2.19951L90.4192 2.20821H90.5C111.984 2.20821 130.012 9.83016 142.234 28.4016C154.52 47.0702 161.077 77.0066 158.989 121.926C153.095 155.359 145.385 185.102 133.16 207.538C121.011 229.838 104.476 244.8 80.886 249.101C56.3373 241.868 39.9103 227.275 28.2091 206.302C16.4187 185.169 9.42403 157.551 3.8751 124.41C-1.14749 81.0439 6.83706 49.0057 22.7846 28.5956C38.6991 8.22774 62.7183 -0.786687 90.3388 2.19951Z\" fill=\"black\" stroke=\"#D02780\" stroke-width=\"3\"/>\n        <rect x=\"0\" y=\"0\" height=\"100%\" width=\"100%\" />\n      </svg>\n    </div>\n    `\n  }\n  responsiveFrameBoxEyesOutterWidth (windowWidth) {\n    switch (windowWidth) {\n      case 818:\n        return {\n          eyesInner: 0.74,\n          eyesOutter: 0.78,\n          box: 0.60\n        }\n        break;\n      case 414:\n        return {\n          eyesInner: 0.68,\n          eyesOutter: 0.72,\n          box: 0.6\n        }\n        break;\n      case 412:\n        return {\n          eyesInner: 0.68,\n          eyesOutter: 0.69,\n          box: 0.6\n        }\n        break;\n      case 375:\n        return {\n          eyesInner: 0.67,\n          eyesOutter: 0.69,\n          box: 0.57\n        }\n        break;\n      case 360:\n        return {\n          eyesInner: 0.63,\n          eyesOutter: 0.67,\n          box: 0.57\n        }\n        break;\n      case 320:\n        return {\n          eyesInner: 0.62,\n          eyesOutter: 0.67,\n          box: 0.57\n        }\n        break;\n      case 315:\n        return {\n          eyesInner: 0.74,\n          eyesOutter: 0.78,\n          box: 0.55\n        }\n        break;\n    \n      default:\n        return {\n          eyesInner: 0.74,\n          eyesOutter: 0.8,\n          box: 0.515\n        }\n        break;\n    }\n  }\n  loop () {\n    if (this.video.style.width.includes('%')) {\n      this.displaySize.width = this.video.style.width = this.video.clientWidth\n      this.displaySize.height = this.video.style.height = this.video.clientHeight\n    }\n    this.canvas = this.faceapi.createCanvasFromMedia(this.video)\n\n    this.canvas.style.position = 'absolute'\n    this.canvas.style.left = 0\n    this.canvas.style.top = 10\n\n    this.canvas.style.width = this.videoWrapper.style.width\n    this.canvas.height = this.videoWrapper.clientHeight\n    this.canvas.style.height = this.videoWrapper.clientHeight\n    this.canvas.style.minHeight = this.videoWrapper.clientHeight\n\n    this.svgTag = document.getElementById('svg-tag')\n\n    this.videoWrapper.append(this.canvas)\n\n    this.faceapi.matchDimensions(this.canvas, this.displaySize)\n    this.svgMask.setAttribute('style', 'display: block; position:absolute; top: 0; left: 0;')\n    this.maskEllipse.setAttribute('style', 'display: block;')\n\n    this.boxesWidth = this.responsiveFrameBoxEyesOutterWidth(window.innerWidth)\n    if (this.configFrameBox) this.boxesWidth = this.configFrameBox\n\n\n    const frameBox = {\n      width: Math.floor(this.config.width * this.boxesWidth.box),\n      height: Math.floor(this.config.height * .922)\n    }\n    frameBox.left = Math.floor((this.canvas.width / 2) - (frameBox.width / 2))\n    frameBox.top = Math.floor( (this.videoWrapper.clientHeight / 2) - (frameBox.height / 2)  )\n    this.svgTag.style.marginTop = frameBox.top\n\n    const height = !!this.configEyesBoxHeight ? (frameBox.height + this.configEyesBoxHeight) : frameBox.height\n    const eyesOutter = {\n      width: Math.floor((frameBox.width * this.boxesWidth.eyesOutter)),\n      height: Math.floor((height / 5))\n    }\n    eyesOutter.left = Math.floor((frameBox.left + (frameBox.width / 1.95) - (eyesOutter.width / 1.95)))\n    eyesOutter.top = Math.floor(frameBox.top + (frameBox.height * 0.3))\n    const eyesInner = {\n      width: Math.floor((frameBox.width * this.boxesWidth.eyesInner)),\n      height: Math.floor((height / 5))\n    }\n    eyesInner.left = Math.floor((frameBox.left + (frameBox.width / 1.96) - (eyesInner.width / 1.96)))\n    eyesInner.top = Math.floor(frameBox.top + (frameBox.height * 0.3))\n\n    const ctx = this.canvas.getContext('2d')\n    ctx.translate(this.canvas.width, 0)\n    ctx.scale(-1, 1)\n\n    // DEBUG\n    if (this.config.isDebug) {\n      this.draw(ctx, this.canvas, frameBox, eyesInner, eyesOutter)\n    }\n\n    const canvasPosition = this.canvas.getBoundingClientRect()\n    const state = {\n      counter: 0,\n      inProgress: false,\n      done: false\n    }\n\n    const timerBackground = setInterval(() => {\n      this.checkBackground()\n    }, 1000);\n\n    const timer = setInterval(async () => {\n      if (state.inProgress || state.done) {\n        return\n      }\n      state.inProgress = true\n\n      const detections = await this.faceapi.detectSingleFace(this.video, new this.faceapi.TinyFaceDetectorOptions())\n        .withFaceLandmarks()\n        .withFaceExpressions()\n\n      this.removeLoading()\n\n      if (!detections) {\n        this.blockMask('Face não encontrada', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n        state.counter = 0\n        state.inProgress = false\n        return\n      }\n\n      const resizedDetections = this.faceapi.resizeResults(detections, this.displaySize)\n\n      if (resizedDetections && resizedDetections.expressions) {  \n        const expression = this.getExpression(resizedDetections.expressions)\n        if (expression !== 'neutral') {\n          if (this.config.isDebug) {\n            this.blockMask(`Mantenha expressão neutra >> ${expression}`, canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          } else {\n            this.blockMask('Mantenha expressão neutra', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          }\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n      }\n      \n      if (resizedDetections.detection) {\n\n        // POSE\n        const pose = this.getPose(resizedDetections)\n        if (pose !== 'front') {\n          if (this.config.isDebug) {\n            this.blockMask(`Centralize seu rosto >> ${pose}`, canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          } else {\n            this.blockMask('Centralize seu rosto', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          }\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        // ANGLE\n        const jaw = resizedDetections.landmarks.getJawOutline()\n        const rotated = this.isRotatedFace(jaw[0], jaw[16])\n        if (rotated) {\n          if (this.config.isDebug) {\n            this.blockMask('Centralize seu rosto >> rotacionado', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          } else {\n            this.blockMask('Centralize seu rosto', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          }\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        // DEBUG\n        if (this.config.isDebug) {\n          this.draw(ctx, this.canvas, frameBox, eyesInner, eyesOutter)\n          ctx.beginPath()\n          ctx.lineWidth = '5'\n          ctx.strokeStyle = '#FFFF00'\n          ctx.moveTo(jaw[0].x, jaw[0].y)\n          ctx.lineTo(jaw[16].x, jaw[16].y)\n          ctx.stroke()\n        }\n\n\n        const leftEye = {\n          meanPosition: [jaw[0].x, jaw[0].y],\n          frameBox: { isInside: false },\n          outterBox: { isInside: false },\n          innerBox: { isInside: false }\n        }\n        const rightEye = { \n          meanPosition: [jaw[16].x, jaw[16].y],\n          frameBox: { isInside: false },\n          outterBox: { isInside: false },\n          innerBox: { isInside: false }\n        }\n\n        leftEye.frameBox.isInside = this.isInside(leftEye.meanPosition, { top: frameBox.top, left: frameBox.left, width: frameBox.width, height: frameBox.height })\n        rightEye.frameBox.isInside = this.isInside(rightEye.meanPosition, { top: frameBox.top, left: frameBox.left, width: frameBox.width, height: frameBox.height })\n\n        leftEye.outterBox.isInside = this.isInside(leftEye.meanPosition, { top: eyesOutter.top, left: eyesOutter.left, width: eyesOutter.width, height: eyesOutter.height })\n        rightEye.outterBox.isInside = this.isInside(rightEye.meanPosition, { top: eyesOutter.top, left: eyesOutter.left, width: eyesOutter.width, height: eyesOutter.height })\n\n        leftEye.innerBox.isInside = this.isInside(leftEye.meanPosition, { top: eyesInner.top, left: eyesInner.left, width: eyesInner.width, height: eyesInner.height })\n        rightEye.innerBox.isInside = this.isInside(rightEye.meanPosition, { top: eyesInner.top, left: eyesInner.left, width: eyesInner.width, height: eyesInner.height })\n\n\n        if (!this.isBackgroundOK) {\n          this.blockMask('O ambiente está escuro', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        if (!leftEye.frameBox.isInside || !rightEye.frameBox.isInside) {\n          this.blockMask('Posicione seu rosto dentro da moldura', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        if (!leftEye.outterBox.isInside || !rightEye.outterBox.isInside) {\n          this.blockMask('Afaste seu rosto', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        if (leftEye.innerBox.isInside || rightEye.innerBox.isInside) {\n          this.blockMask('Aproxime seu rosto', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        this.activateEllipseMask()\n    \n        state.counter += 1\n        state.inProgress = false\n        if (state.counter >= 2) {\n          state.done = true\n          this.takePicture(this.canvas)\n          clearInterval(timer)\n          clearInterval(timerBackground)\n        }\n      }\n      \n    }, 150)\n  }\n  activateEllipseMask () {\n    this.maskEllipse.classList.add('active')\n  }\n  deactivateEllipseMask () {\n    this.maskEllipse.classList.remove('active')\n  }\n  draw (ctx, canvas, frameBox, eyesInner, eyesOutter) {\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\n    ctx.beginPath()\n    ctx.lineWidth = '3'\n    ctx.strokeStyle = 'blue'\n    ctx.rect(frameBox.left, frameBox.top, frameBox.width, frameBox.height)\n    ctx.stroke()\n  \n    ctx.beginPath()\n    ctx.lineWidth = '2'\n    ctx.strokeStyle = 'yellow'\n    ctx.rect(eyesInner.left, eyesInner.top, eyesInner.width, eyesInner.height)\n    ctx.stroke()\n  \n    ctx.beginPath()\n    ctx.lineWidth = '2'\n    ctx.strokeStyle = 'red'\n    ctx.rect(eyesOutter.left, eyesOutter.top, eyesOutter.width, eyesOutter.height)\n    ctx.stroke()\n\n  }\n  getExpression (expressions) {\n    const expArr = []\n    for (const [key, value] of Object.entries(expressions)) {\n      expArr.push({ expression: key, confidence: value })\n    }\n    const exp = expArr.sort((a, b) => a.confidence - b.confidence).pop()\n    return (exp && exp.expression) ? exp.expression : null\n  }\n  getPose(res) {\n    const eye_right = this.getMeanPosition(res.landmarks.getRightEye())\n    const eye_left = this.getMeanPosition(res.landmarks.getLeftEye())\n    const nose = this.getMeanPosition(res.landmarks.getNose())\n    const mouth = this.getMeanPosition(res.landmarks.getMouth())\n    const jaw = this.getTop(res.landmarks.getJawOutline())\n    const rx = (jaw - mouth[1]) / res.detection.box.height + 0.45\n    const ry = (eye_left[0] + (eye_right[0] - eye_left[0]) / 2 - nose[0]) / res.detection.box.width\n    let state = 'undetected'\n\n    if (res.detection.score > 0.3) {\n      state = 'front'\n      if (rx > 0.2) {\n        state = 'top'\n      } else if (rx < -0.1) {\n        state = 'bottom'\n      } else {\n        if (ry < -0.04) {\n          state = 'left'\n        }\n        if (ry > 0.04) {\n          state = 'right'\n        }\n      }\n    }\n    return state\n  }\n  isRotatedFace (p1, p2) {\n    const angleDeg = Math.abs(Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180 / Math.PI)\n    return angleDeg > 7\n  }\n  getMeanPosition (l) {\n    return l\n      .map((a) => [a.x, a.y])\n      .reduce((a, b) => [a[0] + b[0], a[1] + b[1]])\n      .map((a) => a / l.length)\n  }\n  getTop (l) {\n    return l\n      .map((a) => a.y)\n      .reduce((a, b) => Math.min(a, b))\n  }\n  isInside (a = [], b = {}) {\n    if (a[1] < b.top) {\n      return false\n    }\n    if (a[0] < b.left) {\n      return false\n    }\n    if (a[1] > b.top + b.height) {\n      return false\n    }\n    if (a[0] > b.left + b.width) {\n      return false\n    }\n    return true\n  }\n  blockMask (message, canvasPosition, left, top, height, width) {\n    const MASK_WHITE_BORDER = 50\n    const dimensions = {\n      width: 230,\n      height: 35\n    }\n    dimensions.top = top + height + 20\n    dimensions.left = (left + (width / 2)) - (dimensions.width / 2)\n\n\n    this.maskEllipse.classList.remove('active')\n    this.msg.innerHTML = ''\n    const elMessage = document.createElement('span')\n    elMessage.textContent = message\n    elMessage.style = \n    `\n      display: flex;\n      color: #f3f3f5;\n      z-index: 20;\n      font-size: 1.1rem;\n      padding: 10px 20px;\n      text-align: center;\n      align-items: center;\n      background: #D02780;\n      border-radius: 7px;\n      justify-content: center;\n      width: ${dimensions.width}px;\n      height: ${dimensions.height}px;\n      font-family: Prompt, sans-serif;\n    `\n    this.msg.style.display = 'flex'\n    this.msg.appendChild(elMessage)\n  }\n  takePicture (canvas) {\n    const context = this.canvasBackground.getContext('2d')\n    this.canvasBackground.style.display = 'none;'\n    this.createFlashMask()\n    context.drawImage(this.video, 0, 0, this.canvasBackground.width, this.canvasBackground.height)\n    this.base64 = this.canvasBackground.toDataURL('image/png')\n\n    setTimeout(() => {\n      this.removeFlashMask()\n\n      if(this.isShowPreview) {\n        this.openPreviewModal()\n      }\n      else {\n        this.confirmPicture()\n      }\n      \n    }, 300)\n  }\n  checkBackground () {\n    if (!this.canvasBackground) return\n    const context = this.canvasBackground.getContext('2d')\n\n    context.drawImage(this.video, 0, 0, this.canvasBackground.width, this.canvasBackground.height)\n    const pictureData = context.getImageData(0,0,this.canvasBackground.width,this.canvasBackground.height)\n    this.sweepVideo(pictureData.data)\n\n    this.isBackgroundOK = (this.brightness >= this.brightnessControl && this.luminance >= this.luminanceControl)\n\n    if (this.config.isDebug) {\n      const table = {\n        brilho: {\n          atual: this.brightness,\n          'mín aceitável': this.brightnessControl,\n        },\n        'luminânia': {\n          atual: parseFloat(this.luminance.toFixed(2)),\n          'mín aceitável': this.luminanceControl\n        }\n      }\n      console.table(table)\n    }\n  }\n  createFlashMask () {\n    const flash = document.createElement('div')\n    flash.style.width = '100%'\n    flash.style.height = '100vh'\n    flash.style.position = 'fixed'\n    flash.style.background = 'white'\n    flash.style.zIndex = 30\n    flash.style.top = 0\n    flash.style.left = 0\n    flash.id = 'flash'\n    document.body.append(flash)\n  }\n  removeFlashMask () {\n    const flash = document.getElementById('flash')\n    flash.remove()\n  }\n  createMessageBox () {\n    this.msg = document.createElement('div')\n    this.msg.style = `\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 100%;\n      background: transparent;\n      position: absolute;\n      bottom: 0;\n    `\n    this.videoWrapper.append(this.msg)\n    return this\n  }\n  createModalConfirmationWrapper () {\n    this.modalWrapper = document.createElement('div')\n    this.modalWrapper.style = `\n    top: 0;\n    left: 0;\n    z-index: 10;\n    width: 100%;\n    height: 100%;\n    display: none;\n    position: fixed;\n    align-items: center;\n    justify-content: center;\n    background: rgba(20, 20, 20, 0.95);\n    `\n    this.modalWrapper.id = 'modalWrapper'\n    document.body.append(this.modalWrapper)\n    return this\n  }\n  createModalConfirmation () {\n    this.modalConfirmation = document.createElement('div')\n    this.modalConfirmation.style = `\n    padding: 7px;\n    display: flex;\n    max-width: 720px;\n    background: white;\n    max-height: 560px;\n    border-radius: 7px;\n    position: relative;\n    align-items: center;\n    justify-content: center;\n    `\n    const confirmButton = document.createElement('button')\n    confirmButton.textContent = 'Confirmar'\n    confirmButton.style = `\n    color: #555;\n    right: 10px;\n    width: 160px;\n    height: 50px;\n    bottom: 10px;\n    cursor: pointer;\n    background: #fff;\n    font-weight: 600;\n    border-radius: 7px;\n    margin-right: 10px;\n    border: 1px solid #222;\n    `\n    const cancelButton = document.createElement('button')\n    cancelButton.textContent = 'Cancelar'\n    cancelButton.style = `\n    color: #444;\n    right: 10px;\n    width: 160px;\n    height: 50px;\n    bottom: 10px;\n    cursor: pointer;\n    background: #fff;\n    font-weight: 600;\n    border-radius: 7px;\n    margin-right: 10px;\n    border: 1px solid #222;\n    `\n    const footer = document.createElement('div')\n    footer.style = `\n    right: 0;\n    bottom: 0;\n    width: 100%;\n    display: flex;\n    padding: 10px 0;\n    position: absolute;\n    justify-content: center;\n    `\n    footer.append(cancelButton)\n    footer.append(confirmButton)\n    this.modalConfirmation.append(footer)\n    this.modalWrapper.append(this.modalConfirmation)\n    confirmButton.addEventListener('click', () => {\n      this.closePreviewModal()\n      this.confirmPicture()\n    })\n    cancelButton.addEventListener('click', () => {\n      this.cancelPicture()\n    })\n    return this\n  }\n\n  openPreviewModal () {\n    const image = document.createElement('img')\n    image.src = this.base64\n    image.style = `\n      max-width: ${this.canvasBackground.width};\n      min-width: ${this.canvasBackground.width};\n      min-height: ${this.canvasBackground.height};\n      max-height: ${this.canvasBackground.height};\n      object-fit: cover;\n      border-radius: 7px;\n    `\n    this.modalConfirmation.append(image)\n    this.modalWrapper.style.display = 'flex'\n  }\n\n  closePreviewModal () {\n    const modal = document.getElementById('modalWrapper')\n    if (modal) modal.remove()\n  }\n\n  cancelPicture () {\n    this.resetLiveness()\n  }\n\n  setLoading () { \n    const spinner = `<div id=\"spinner\">\n        <div class=\"lds-ripple\">\n          <div style=\"color: white\"></div>\n          <div style=\"color: white\"></div>\n        </div>\n        <style>\n        #spinner {\n          z-index: 40;\n          width: 100%;\n          height: 100%;\n          display: flex;\n          position: absolute;\n          align-items: center;\n          justify-content: center;\n          background: rgba(20, 20, 20, 1);\n          top: 0;\n        }\n        .lds-ripple {\n          width: 80px;\n          height: 80px;\n          position: relative;\n        }\n        .lds-ripple div {\n          position: absolute;\n          border: 4px solid #000;\n          opacity: 1;\n          border-radius: 50%;\n          border-color: white;\n          animation: lds-ripple 1s cubic-bezier(0, 0.2, 0.8, 1) infinite;\n        }\n        .lds-ripple div:nth-child(2) {\n          animation-delay: -0.5s;\n        }\n        @keyframes lds-ripple {\n          0% {\n            top: 36px;\n            left: 36px;\n            width: 0;\n            height: 0;\n            opacity: 1;\n            color: white;\n          }\n          100% {\n            top: 0px;\n            left: 0px;\n            width: 72px;\n            height: 72px;\n            opacity: 0;\n          }\n        }\n        </style>\n      </div>`\n    this.videoWrapper.insertAdjacentHTML('beforeend', spinner)\n  }\n  removeLoading () {\n    const spinner = document.getElementById('spinner')\n    if(spinner) spinner.remove()\n  }\n\n  confirmPicture () {\n    const base64Local = this.base64\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${this.token}`\n      },\n      body: JSON.stringify({\n        base64: {\n          key: base64Local.replace('data:image/png;base64,', '')\n        }\n      })\n    }\n    this.setLoading()\n    const endpoint = `${this.livenessUrlBase}${this.livenessConfirmEndpoint}`\n    fetch(endpoint, requestOptions)\n      .then(response => response.json())\n      .then(result => {\n        if (result?.data) {\n          this.successCallback({...result, base64: this.base64})\n          return\n        }\n\n        if (result?.error?.statusCode === 401) {\n          alert('Token inválido')\n          return\n        }\n\n        this.errorCallback({ error: result?.error, base64: this.base64})\n        console.error('error:', result?.error?.message)\n\n      })\n      .catch(error => {\n        error.base64 = this.base64\n        this.errorCallback(error)\n      })\n      .finally(() => {\n        this.resetLiveness()\n        this.removeLoading()\n      })\n  }\n}\n\nmodule.exports = Liveness\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(708);\n"],"sourceRoot":""}