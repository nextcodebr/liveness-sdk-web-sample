{"version":3,"sources":["webpack://Liveness/./src/Livenessv4.js","webpack://Liveness/webpack/bootstrap","webpack://Liveness/webpack/startup"],"names":["module","exports","constructor","videoWrapper","config","height","Math","floor","width","this","token","faceapi","faceapiPath","isShowPreview","errorCallback","successCallback","livenessUrlBase","displaySize","livenessConfirmEndpoint","window","setLiveness","loadFaceApi","setLoading","createModalConfirmationWrapper","createModalConfirmation","createVideoElement","startVideo","resetLiveness","removeCanvas","resetVideoWrapper","closePreviewModal","base64","removeLoading","script","document","createElement","faceJS","src","head","append","onload","async","loadFaceApiModels","setTimeout","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","faceExpressionNet","navigator","mediaDevices","getUserMedia","video","then","stream","srcObject","catch","err","console","error","style","transform","setAttribute","position","setVideoMask","addEventListener","createMessageBox","loop","getElementById","innerHTML","canvas","getElementsByTagName","remove","insertAdjacentHTML","createMask","maskEllipse","svgMask","includes","clientWidth","createCanvasFromMedia","left","top","matchDimensions","frameBox","eyesOutter","eyesInner","ctx","getContext","translate","scale","isDebug","draw","canvasPosition","getBoundingClientRect","state","counter","inProgress","done","timer","setInterval","detections","detectSingleFace","TinyFaceDetectorOptions","withFaceLandmarks","withFaceExpressions","blockMask","resizedDetections","resizeResults","expressions","expression","getExpression","detection","pose","getPose","jaw","landmarks","getJawOutline","isRotatedFace","beginPath","lineWidth","strokeStyle","moveTo","x","y","lineTo","stroke","leftEye","meanPosition","isInside","outterBox","innerBox","rightEye","msg","activateEllipseMask","takePicture","clearInterval","deactivateEllipseMask","clearRect","rect","expArr","key","value","Object","entries","push","confidence","exp","sort","a","b","pop","res","eye_right","getMeanPosition","getRightEye","eye_left","getLeftEye","nose","getNose","mouth","getMouth","rx","getTop","box","ry","score","p1","p2","abs","atan2","PI","l","map","reduce","length","min","message","dimensions","textContent","context","drawImage","toDataURL","openPreviewModal","confirmPicture","modalWrapper","id","body","modalConfirmation","confirmButton","cancelButton","footer","cancelPicture","image","display","modal","spinner","requestOptions","method","headers","JSON","stringify","replace","endpoint","fetch","response","json","result","statusCode","alert","success","data","real","parseFloat","isAlive","log","finally","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__"],"mappings":"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","file":"liveness.js","sourcesContent":["\"use strict\";\nclass Liveness {\n  constructor (videoWrapper, config) {\n    config.height = Math.floor(config.width * 0.7778)\n    this.config = config\n    this.token = config.token\n    this.videoWrapper = videoWrapper\n    this.faceapi = null\n    this.faceapiPath = config.faceapiPath\n    this.isShowPreview = config.isShowPreview\n    this.errorCallback = config.errorCallback\n    this.successCallback = config.successCallback\n    this.livenessUrlBase = config.livenessUrlBase\n    this.displaySize = { width: config.width, height: config.height }\n    this.livenessConfirmEndpoint = config.livenessConfirmEndpoint || '/liveness/v2'\n  }\n  async start () {\n    if (!window.faceapi) {\n      await this.loadFaceApi()\n    } else {\n      this.faceapi = window.faceapi\n      this.setLiveness()\n    }\n  }\n\n  setLiveness () {\n    this.setLoading()\n    this.createModalConfirmationWrapper()\n    .createModalConfirmation()\n    .createVideoElement()\n    .startVideo()\n  }\n  resetLiveness () {\n    this.removeCanvas()\n    this.resetVideoWrapper()\n    this.closePreviewModal()\n    this.base64 = ''\n    this.removeLoading()\n    this.setLiveness()\n  }\n\n  async loadFaceApi () {\n    const script = document.createElement('script')\n    const faceJS = `${this.faceapiPath}/face-api.min.js`\n    script.src = faceJS\n    document.head.append(script)\n    script.onload = async () => {\n      await this.loadFaceApiModels()\n    }\n    return this\n  }\n  async loadFaceApiModels () {\n    setTimeout(async () => {\n      await faceapi.nets.tinyFaceDetector.loadFromUri(this.faceapiPath)\n      await faceapi.nets.faceLandmark68Net.loadFromUri(this.faceapiPath)\n      await faceapi.nets.faceRecognitionNet.loadFromUri(this.faceapiPath)\n      await faceapi.nets.faceExpressionNet.loadFromUri(this.faceapiPath)\n      this.faceapi = faceapi\n      this.setLiveness()\n    }, 1000)\n    return this\n  }\n\n  startVideo () {\n    const timer = setTimeout(() => {\n      navigator.mediaDevices\n        .getUserMedia({\n          video: {}\n        }).then((stream) => {\n          this.video.srcObject = stream\n        }).catch(err => console.error(err))\n    }, 100)\n    return this\n  }\n  createVideoElement () {\n    this.video = document.createElement('video')\n    this.video.style.width = this.config.width\n    this.video.style.height = this.config.height\n    this.video.style.transform = 'scaleX(-1)'\n    this.video.setAttribute('muted', true)\n    this.video.setAttribute('autoplay', true)\n    this.videoWrapper.style.position = 'relative'\n    this.videoWrapper.style.width = this.config.width\n    this.videoWrapper.style.height = this.config.height\n    this.videoWrapper.append(this.video)\n    this.setVideoMask()\n    this.video.addEventListener('play', () => {\n      this.createMessageBox()\n      this.loop()\n    })\n    return this\n  }\n  resetVideoWrapper () {\n    const videoWrapper = document.getElementById('video-wrapper')\n    if(videoWrapper) videoWrapper.innerHTML = ''\n  }\n\n  removeCanvas () {\n    const canvas = document.getElementsByTagName('canvas')[0]\n    if(canvas) canvas.remove()\n  }\n\n  setVideoMask () {\n    this.videoWrapper.insertAdjacentHTML('beforeend', this.createMask())\n    this.maskEllipse = document.getElementById('mask-ellipse')\n    this.svgMask = document.getElementById('svg-mask')\n    this.svgMask.style.width = this.config.width\n    this.svgMask.style.height = this.config.height\n  }\n  createMask () {\n    return `<svg\n    id=\"svg-mask\"\n    style=\"display: none;\"\n    viewBox=\"0 0 720 560\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      id=\"mask-ellipse\"\n      d=\"M507.5 275C507.5 332.25 490.842 383.977 464.035 421.328C437.225 458.683 400.41 481.5 360 481.5C319.59 481.5 282.775 458.683 255.965 421.328C229.158 383.977 212.5 332.25 212.5 275C212.5 217.75 229.158 166.023 255.965 128.672C282.775 91.3174 319.59 68.5 360 68.5C400.41 68.5 437.225 91.3174 464.035 128.672C490.842 166.023 507.5 217.75 507.5 275Z\"\n      stroke=\"#B40000\"\n      stroke-width=\"5\"\n    />\n    <path\n      fill-rule=\"evenodd\"\n      clip-rule=\"evenodd\"\n      d=\"M21 10C15.4772 10 11 14.4772 11 20V542C11 547.523 15.4771 552 21 552H698C703.523 552 708 547.523 708 542V20C708 14.4772 703.523 10 698 10H21ZM360 481C441.186 481 507 388.771 507 275C507 161.229 441.186 69 360 69C278.814 69 213 161.229 213 275C213 388.771 278.814 481 360 481Z\"\n      fill=\"#000\"\n      fill-opacity=\"0.6\"\n    />\n    <rect\n      x=\"12.5\"\n      y=\"12.5\"\n      width=\"695\"\n      height=\"535\"\n      stroke=\"white\"\n      stroke-width=\"25\"\n    />\n  </svg>`\n  }\n  loop () {\n    if (this.video.style.width.includes('%')) {\n      this.displaySize.width = this.video.clientWidth\n      this.video.style.width = this.video.clientWidth\n    }\n    const canvas = this.faceapi.createCanvasFromMedia(this.video)\n\n    canvas.style.position = 'absolute'\n    canvas.style.left = 0\n    canvas.style.top = 8\n\n    canvas.style.width = this.videoWrapper.style.width\n    canvas.style.height = this.videoWrapper.style.height\n\n    this.videoWrapper.append(canvas)\n\n    this.faceapi.matchDimensions(canvas, this.displaySize)\n    this.svgMask.setAttribute('style', 'display: block; position:absolute; top: 0; left: 0;')\n    this.maskEllipse.setAttribute('style', 'display: block;')\n    \n    const frameBox = {\n      width: Math.floor(this.config.width * .515),\n      height: Math.floor(this.config.height * .922)\n    }\n    frameBox.left = Math.floor((canvas.width / 1.95) - (frameBox.width / 1.95))\n    frameBox.top = Math.floor((canvas.height - frameBox.height) / 2.25)\n    const eyesOutter = {\n      width: Math.floor((frameBox.width * 0.8)),\n      height: Math.floor((frameBox.height / 5))\n    }\n    eyesOutter.left = Math.floor((frameBox.left + (frameBox.width / 1.95) - (eyesOutter.width / 1.95)))\n    eyesOutter.top = Math.floor(frameBox.top + (frameBox.height * 0.4))\n    const eyesInner = {\n      width: Math.floor((frameBox.width * 0.68)),\n      height: Math.floor((frameBox.height / 5))\n    }\n    eyesInner.left = Math.floor((frameBox.left + (frameBox.width / 1.96) - (eyesInner.width / 1.96)))\n    eyesInner.top = Math.floor(frameBox.top + (frameBox.height * 0.4))\n\n    const ctx = canvas.getContext('2d')\n    ctx.translate(canvas.width, 0)\n    ctx.scale(-1, 1)\n\n    // DEBUG\n    if (this.config.isDebug) {\n      this.draw(ctx, canvas, frameBox, eyesInner, eyesOutter)\n    }\n\n    const canvasPosition = canvas.getBoundingClientRect()\n    const state = {\n      counter: 0,\n      inProgress: false,\n      done: false\n    }\n\n    const timer = setInterval(async () => {\n      if (state.inProgress || state.done) {\n        return\n      }\n      state.inProgress = true\n\n      const detections = await this.faceapi.detectSingleFace(this.video, new this.faceapi.TinyFaceDetectorOptions())\n        .withFaceLandmarks()\n        .withFaceExpressions()\n\n      this.removeLoading()\n\n      if (!detections) {\n        this.blockMask('Face não encontrada', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n        state.counter = 0\n        state.inProgress = false\n        return\n      }\n\n      const resizedDetections = this.faceapi.resizeResults(detections, this.displaySize)\n\n      if (resizedDetections && resizedDetections.expressions) {  \n        const expression = this.getExpression(resizedDetections.expressions)\n        if (expression !== 'neutral') {\n          if (this.config.isDebug) {\n            this.blockMask(`Mantenha expressão neutra >> ${expression}`, canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          } else {\n            this.blockMask('Mantenha expressão neutra', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          }\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n      }\n      \n      if (resizedDetections.detection) {\n\n        // POSE\n        const pose = this.getPose(resizedDetections)\n        if (pose !== 'front') {\n          if (this.config.isDebug) {\n            this.blockMask(`Centralize seu rosto >> ${pose}`, canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          } else {\n            this.blockMask('Centralize seu rosto', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          }\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        // ANGLE\n        const jaw = resizedDetections.landmarks.getJawOutline()\n        const rotated = this.isRotatedFace(jaw[0], jaw[16])\n        if (rotated) {\n          if (this.config.isDebug) {\n            this.blockMask('Centralize seu rosto >> rotacionado', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          } else {\n            this.blockMask('Centralize seu rosto', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          }\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        // DEBUG\n        if (this.config.isDebug) {\n          this.draw(ctx, canvas, frameBox, eyesInner, eyesOutter)\n          ctx.beginPath()\n          ctx.lineWidth = '5'\n          ctx.strokeStyle = 'green'\n          ctx.moveTo(jaw[0].x, jaw[0].y)\n          ctx.lineTo(jaw[16].x, jaw[16].y)\n          ctx.stroke()\n        }\n\n\n        const leftEye = {\n          meanPosition: [jaw[0].x, jaw[0].y],\n          frameBox: { isInside: false },\n          outterBox: { isInside: false },\n          innerBox: { isInside: false }\n        }\n        const rightEye = { \n          meanPosition: [jaw[16].x, jaw[16].y],\n          frameBox: { isInside: false },\n          outterBox: { isInside: false },\n          innerBox: { isInside: false }\n        }\n\n        leftEye.frameBox.isInside = this.isInside(leftEye.meanPosition, { top: frameBox.top, left: frameBox.left, width: frameBox.width, height: frameBox.height })\n        rightEye.frameBox.isInside = this.isInside(rightEye.meanPosition, { top: frameBox.top, left: frameBox.left, width: frameBox.width, height: frameBox.height })\n\n        leftEye.outterBox.isInside = this.isInside(leftEye.meanPosition, { top: eyesOutter.top, left: eyesOutter.left, width: eyesOutter.width, height: eyesOutter.height })\n        rightEye.outterBox.isInside = this.isInside(rightEye.meanPosition, { top: eyesOutter.top, left: eyesOutter.left, width: eyesOutter.width, height: eyesOutter.height })\n\n        leftEye.innerBox.isInside = this.isInside(leftEye.meanPosition, { top: eyesInner.top, left: eyesInner.left, width: eyesInner.width, height: eyesInner.height })\n        rightEye.innerBox.isInside = this.isInside(rightEye.meanPosition, { top: eyesInner.top, left: eyesInner.left, width: eyesInner.width, height: eyesInner.height })\n        \n        if (!leftEye.frameBox.isInside || !rightEye.frameBox.isInside) {\n          this.blockMask('Posicione seu rosto dentro da moldura', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        if (!leftEye.outterBox.isInside || !rightEye.outterBox.isInside) {\n          this.blockMask('Afaste seu rosto', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        if (leftEye.innerBox.isInside || rightEye.innerBox.isInside) {\n          this.blockMask('Aproxime seu rosto', canvasPosition, frameBox.left, frameBox.top, frameBox.height, frameBox.width)\n          state.counter = 0\n          state.inProgress = false\n          return\n        }\n\n        this.msg.style = 'display: none;'\n        this.activateEllipseMask()\n        state.counter += 1\n        state.inProgress = false\n        if (state.counter >= 2) {\n          state.done = true\n          this.takePicture(canvas)\n          clearInterval(timer)\n        }\n      }\n      \n    }, 250)\n  }\n  activateEllipseMask () {\n    this.maskEllipse.setAttribute('stroke', '#0F0')\n  }\n  deactivateEllipseMask () {\n    this.maskEllipse.setAttribute('stroke', '#F00')\n  }\n  draw (ctx, canvas, frameBox, eyesInner, eyesOutter) {\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\n    ctx.beginPath()\n    ctx.lineWidth = '3'\n    ctx.strokeStyle = 'blue'\n    ctx.rect(frameBox.left, frameBox.top, frameBox.width, frameBox.height)\n    ctx.stroke()\n  \n    ctx.beginPath()\n    ctx.lineWidth = '2'\n    ctx.strokeStyle = 'yellow'\n    ctx.rect(eyesInner.left, eyesInner.top, eyesInner.width, eyesInner.height)\n    ctx.stroke()\n  \n    ctx.beginPath()\n    ctx.lineWidth = '2'\n    ctx.strokeStyle = 'red'\n    ctx.rect(eyesOutter.left, eyesOutter.top, eyesOutter.width, eyesOutter.height)\n    ctx.stroke()\n  }\n  getExpression (expressions) {\n    const expArr = []\n    for (const [key, value] of Object.entries(expressions)) {\n      expArr.push({ expression: key, confidence: value })\n    }\n    const exp = expArr.sort((a, b) => a.confidence - b.confidence).pop()\n    return (exp && exp.expression) ? exp.expression : null\n  }\n  getPose(res) {\n    const eye_right = this.getMeanPosition(res.landmarks.getRightEye())\n    const eye_left = this.getMeanPosition(res.landmarks.getLeftEye())\n    const nose = this.getMeanPosition(res.landmarks.getNose())\n    const mouth = this.getMeanPosition(res.landmarks.getMouth())\n    const jaw = this.getTop(res.landmarks.getJawOutline())\n    const rx = (jaw - mouth[1]) / res.detection.box.height + 0.5\n    const ry = (eye_left[0] + (eye_right[0] - eye_left[0]) / 2 - nose[0]) / res.detection.box.width\n    let state = 'undetected'\n\n    if (res.detection.score > 0.3) {\n      state = 'front'\n      if (rx > 0.2) {\n        state = 'top'\n      } else if (rx < -0.1) {\n        state = 'bottom'\n      } else {\n        if (ry < -0.04) {\n          state = 'left'\n        }\n        if (ry > 0.04) {\n          state = 'right'\n        }\n      }\n    }\n    return state\n  }\n  isRotatedFace (p1, p2) {\n    const angleDeg = Math.abs(Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180 / Math.PI)\n    return angleDeg > 7\n  }\n  getMeanPosition (l) {\n    return l\n      .map((a) => [a.x, a.y])\n      .reduce((a, b) => [a[0] + b[0], a[1] + b[1]])\n      .map((a) => a / l.length)\n  }\n  getTop (l) {\n    return l\n      .map((a) => a.y)\n      .reduce((a, b) => Math.min(a, b));\n  }\n  isInside (a = [], b = {}) {\n    if (a[1] < b.top) {\n      return false\n    }\n    if (a[0] < b.left) {\n      return false\n    }\n    if (a[1] > b.top + b.height) {\n      return false\n    }\n    if (a[0] > b.left + b.width) {\n      return false\n    }\n    return true\n  }\n  blockMask (message, canvasPosition, left, top, height, width) {\n    const dimensions = {\n      width: 230,\n      height: 35\n    }\n    dimensions.top = top + height + 20\n    dimensions.left = (left + (width / 2)) - (dimensions.width / 2)\n\n    this.maskEllipse.setAttribute('stroke', '#B40000')\n    this.msg.textContent = message\n    this.msg.style = `\n      padding: 10px;\n      color: #ba3939;\n      position: absolute;\n      text-align: center;\n      background: #ffe0e0;\n      top: ${dimensions.top}px;\n      left: ${dimensions.left}px;\n      width: ${dimensions.width}px; \n      height: ${dimensions.height}px;\n      border: 1px solid #a33a3a;\n      font-family: 'Prompt', sans-serif;\n    `\n  }\n  takePicture (canvas) {\n    const context = canvas.getContext('2d')\n    canvas.style = 'display: none;' \n    context.drawImage(this.video, 0, 0, canvas.width, canvas.height)\n    this.base64 = canvas.toDataURL('image/png')\n\n    if(this.isShowPreview) {\n      this.openPreviewModal()\n    }\n    else {\n      this.confirmPicture()\n    }\n  }\n  createMessageBox () {\n    this.msg = document.createElement('div')\n    this.videoWrapper.append(this.msg)\n    return this\n  }\n  createModalConfirmationWrapper () {\n    this.modalWrapper = document.createElement('div')\n    this.modalWrapper.style = `\n    top: 0;\n    left: 0;\n    z-index: 10;\n    width: 100%;\n    height: 100%;\n    display: none;\n    position: fixed;\n    align-items: center;\n    justify-content: center;\n    background: rgba(20, 20, 20, 0.95);\n    `\n    this.modalWrapper.id = 'modalWrapper'\n    document.body.append(this.modalWrapper)\n    return this\n  }\n  createModalConfirmation () {\n    this.modalConfirmation = document.createElement('div')\n    this.modalConfirmation.style = `\n    padding: 7px;\n    display: flex;\n    max-width: 720px;\n    background: white;\n    max-height: 560px;\n    border-radius: 7px;\n    position: relative;\n    align-items: center;\n    justify-content: center;\n    `\n    const confirmButton = document.createElement('button')\n    confirmButton.textContent = 'Confirmar'\n    confirmButton.style = `\n    color: #555;\n    right: 10px;\n    width: 160px;\n    height: 50px;\n    bottom: 10px;\n    cursor: pointer;\n    background: #fff;\n    font-weight: 600;\n    border-radius: 7px;\n    margin-right: 10px;\n    border: 1px solid #222;\n    `\n    const cancelButton = document.createElement('button')\n    cancelButton.textContent = 'Cancelar'\n    cancelButton.style = `\n    color: #444;\n    right: 10px;\n    width: 160px;\n    height: 50px;\n    bottom: 10px;\n    cursor: pointer;\n    background: #fff;\n    font-weight: 600;\n    border-radius: 7px;\n    margin-right: 10px;\n    border: 1px solid #222;\n    `\n    const footer = document.createElement('div')\n    footer.style = `\n    right: 0;\n    bottom: 0;\n    width: 100%;\n    display: flex;\n    padding: 10px 0;\n    position: absolute;\n    justify-content: center;\n    `\n    footer.append(cancelButton)\n    footer.append(confirmButton)\n    this.modalConfirmation.append(footer)\n    this.modalWrapper.append(this.modalConfirmation)\n    confirmButton.addEventListener('click', () => {\n      this.closePreviewModal()\n      this.confirmPicture()\n    })\n    cancelButton.addEventListener('click', () => {\n      this.cancelPicture()\n    })\n    return this\n  }\n\n  openPreviewModal () {\n    const image = document.createElement('img')\n    image.src = this.base64\n    image.style = `\n      max-width: 720px;\n      min-width: 520px;\n      min-height: 360px;\n      max-height: 560px;\n      object-fit: cover;\n      border-radius: 7px;\n    `\n    this.modalConfirmation.append(image)\n    this.modalWrapper.style.display = 'flex'\n  }\n\n  closePreviewModal () {\n    const modal = document.getElementById('modalWrapper')\n    if (modal) modal.remove()\n  }\n\n  cancelPicture () {\n    this.resetLiveness()\n  }\n\n  setLoading () { \n    const spinner = `<div id=\"spinner\">\n        <div class=\"lds-ripple\">\n          <div style=\"color: white\"></div>\n          <div style=\"color: white\"></div>\n        </div>\n        <style>\n        #spinner {\n          z-index: 40;\n          align-content: center;\n          width: 100%;\n          height: 100%;\n          display: flex;\n          position: absolute;\n          align-items: center;\n          justify-content: center;\n          background: rgba(20, 20, 20, 1);\n          top: 0;\n        }\n        .lds-ripple {\n          width: 80px;\n          height: 80px;\n          position: relative;\n        }\n        .lds-ripple div {\n          position: absolute;\n          border: 4px solid #000;\n          opacity: 1;\n          border-radius: 50%;\n          border-color: white;\n          animation: lds-ripple 1s cubic-bezier(0, 0.2, 0.8, 1) infinite;\n        }\n        .lds-ripple div:nth-child(2) {\n          animation-delay: -0.5s;\n        }\n        @keyframes lds-ripple {\n          0% {\n            top: 36px;\n            left: 36px;\n            width: 0;\n            height: 0;\n            opacity: 1;\n            color: white;\n          }\n          100% {\n            top: 0px;\n            left: 0px;\n            width: 72px;\n            height: 72px;\n            opacity: 0;\n          }\n        }\n        </style>\n      </div>`\n    this.videoWrapper.insertAdjacentHTML('beforeend', spinner)\n  }\n  removeLoading () {\n    const spinner = document.getElementById('spinner')\n    if(spinner) spinner.remove()\n  }\n\n  confirmPicture () {\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${this.token}`\n      },\n      body: JSON.stringify({\n        base64: {\n          key: this.base64.replace('data:image/png;base64,', '')\n        }\n      })\n    }\n    this.setLoading()\n    const endpoint = `${this.livenessUrlBase}${this.livenessConfirmEndpoint}`\n    fetch(endpoint, requestOptions)\n      .then(response => response.json())\n      .then(result => { \n        if (result && result.error && result.error.statusCode === 401) {\n          alert('Token inválido')\n          this.resetLiveness()\n          this.errorCallback(result)\n          return\n        }\n  \n        let success = false \n  \n        if (result && result.data && result.data.real && parseFloat(result.data.real) > 0.97) {\n          success = true\n        }\n        if (result && result.isAlive) {\n          success = true\n        }\n        \n        if (success) {\n          this.successCallback(result)\n        } else {\n          this.errorCallback(result)\n        }\n      })\n      .catch(error => {\n        console.log('error', error)\n        this.errorCallback(error)\n      })\n      .finally(() => {\n        this.resetLiveness()\n        this.removeLoading()\n      })\n  }\n}\n\nmodule.exports = Liveness\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(648);\n"],"sourceRoot":""}